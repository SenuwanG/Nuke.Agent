import rpm 
from fpdf import FPDF
import requests

# Open RPM database
ts = rpm.ts()
ts.setVSFlags(rpm._RPMVSF_NOSIGNATURES)

# Create PDF object
pdf = FPDF()  

# Add page  
pdf.add_page()   

# Set font    
pdf.set_font("Arial", size = 15)

# Add title
pdf.cell(200, 10, txt = "Installed Software Report", 
             ln = 1, align = 'C')

# Get installed packages     
for header in ts.dbMatch():
    name = header['name'] 
    version = header['version']
    
    # Add to PDF
    pdf.cell(0, 10, txt= f"{name} {version}", ln = 1)

# Save PDF data    
pdf.output("report.pdf")

# Send PDF in HTTP request
files = {'report': open('report.pdf', 'rb')}  
requests.post(url, files=files)
