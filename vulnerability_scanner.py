import subprocess

def get_installed_packages():
    try:
        cmd = "dpkg-query -W -f='${Package}\t${Version}\n'"
        result = subprocess.check_output(cmd, shell=True, universal_newlines=True)
        return result.strip().split('\n')
    except subprocess.CalledProcessError as e:
        print(f"Error: {e}")
        return []

def generate_report(installed_packages):
    report = "Software Report:\n\n"
    for package_info in installed_packages:
        package, version = package_info.split('\t')
        report += f"{package}: {version}\n"
    return report

def save_report_to_file(report, filename="software_report.txt"):
    try:
        with open(filename, "w") as file:
            file.write(report)
        print(f"Report saved to {filename}")
    except IOError as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    installed_packages = get_installed_packages()
    report = generate_report(installed_packages)
    print(report)

    save_to_file = input("Do you want to save the report to a file? (y/n): ").lower()
    if save_to_file == "y":
        save_report_to_file(report)
